<!DOCTYPE html>
<html>
<head>
    <title>Metrics Results Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        .metric-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #2E8B57;
        }
        
        .metric-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .plot-container {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #eee;
            border-radius: 8px;
            background-color: #fff;
        }
        
        .section-title {
            font-size: 24px;
            font-weight: bold;
            margin: 30px 0 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #2E8B57;
        }
        
        .stats-table {
            width: 100%;
            margin: 15px 0;
        }
        
        .stats-table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        .group-label {
            font-weight: 600;
            color: #2E8B57;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <h1 class="text-center mb-4">Metrics Results Report</h1>
        
        <!-- Summary Dashboard -->
        <div class="section-title">Summary Dashboard</div>
        <div class="plot-container">
            <iframe src="{{ plot_paths['dashboard'] }}" width="100%" height="600px" frameborder="0"></iframe>
        </div>
        
        <!-- Statistics Summary -->
        <div class="section-title">Statistics Summary</div>
        <div class="row">
            {% for metric in metric_names %}
            <div class="col-md-6">
                <div class="metric-card">
                    <h3>{{ metric }}</h3>
                    {% if group_by %}
                        {% for group, group_stats in stats[metric].items() %}
                        <div class="group-label">{{ group }}</div>
                        <table class="table stats-table">
                            <tr>
                                <th>Mean</th>
                                <td>{{ "%.3f"|format(group_stats.mean) }}</td>
                                <th>Std</th>
                                <td>{{ "%.3f"|format(group_stats.std) }}</td>
                            </tr>
                            <tr>
                                <th>Min</th>
                                <td>{{ "%.3f"|format(group_stats.min) }}</td>
                                <th>Max</th>
                                <td>{{ "%.3f"|format(group_stats.max) }}</td>
                            </tr>
                            <tr>
                                <th>Median</th>
                                <td colspan="3">{{ "%.3f"|format(group_stats.median) }}</td>
                            </tr>
                        </table>
                        {% endfor %}
                    {% else %}
                        <table class="table stats-table">
                            <tr>
                                <th>Mean</th>
                                <td>{{ "%.3f"|format(stats[metric].mean) }}</td>
                                <th>Std</th>
                                <td>{{ "%.3f"|format(stats[metric].std) }}</td>
                            </tr>
                            <tr>
                                <th>Min</th>
                                <td>{{ "%.3f"|format(stats[metric].min) }}</td>
                                <th>Max</th>
                                <td>{{ "%.3f"|format(stats[metric].max) }}</td>
                            </tr>
                            <tr>
                                <th>Median</th>
                                <td colspan="3">{{ "%.3f"|format(stats[metric].median) }}</td>
                            </tr>
                        </table>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Metric Details -->
        <div class="section-title">Metric Details</div>
        {% for metric in metric_names %}
        <div class="metric-card">
            <h3>{{ metric }}</h3>
            
            <!-- History Plot -->
            <div class="plot-container">
                <h4>History</h4>
                <iframe src="{{ plot_paths[metric + '_history'] }}" width="100%" height="400px" frameborder="0"></iframe>
            </div>
            
            <!-- Distribution Plot -->
            <div class="plot-container">
                <h4>Distribution</h4>
                <iframe src="{{ plot_paths[metric + '_distribution'] }}" width="100%" height="400px" frameborder="0"></iframe>
            </div>
        </div>
        {% endfor %}
        
        <!-- Correlations -->
        <div class="section-title">Metric Correlations</div>
        <div class="row">
            {% for metric_x in metric_names %}
                {% for metric_y in metric_names %}
                    {% if metric_x < metric_y %}
                    <div class="col-md-6">
                        <div class="plot-container">
                            <h4>{{ metric_x }} vs {{ metric_y }}</h4>
                            <iframe src="{{ plot_paths['correlation_' + metric_x + '_' + metric_y] }}" width="100%" height="400px" frameborder="0"></iframe>
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
            {% endfor %}
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html> 